(function($){$.dataBind=function(){var plugin=this;plugin.set=function(selector,data){var element=$(selector);if(element.length>1)return element.each(function(i,o){plugin.assignData(o,data)});if(element.is(":input"))element.val(data).change();else if(element.is("img"))element.attr("src",data);else element.html(data);element.attr("data-bindfield",true);return element};plugin.setData=function(selector,data){if($.isPlainObject(data))plugin.bind(selector,data);else if($.isArray(data))plugin.bindArray(selector,
data);else plugin.set(selector,data);return selector};plugin.bindArray=function(selector,data){var element=$(selector);var prototype=element.filter(':first, [data-proto][data-proto!=""]').last();element.not(prototype).remove();var results=$();$.each(data,function(i,value){var field=prototype.clone().insertBefore(prototype);plugin.setData(field,value);results=results.add(field)});prototype.remove();return results};plugin.bind=function(selector,data){if($.isArray(data))return plugin.bindArray(selector,
data);var element=$(selector);$.each(data,function(key,value){var field=element.lazyFind('[data-bindname="'+key+'"]');plugin.setData(field,value)});return element};plugin.extract=function(selector){var element=$(selector);if(element.attr("data-bindfield")||!element.children().length)return element.html();var data={};element.lazyFind('[data-bindname][data-bindname!=""]').each(function(i,o){o=$(o);var name=o.attr("data-bindname");if(name&&!data.hasOwnProperty(name))data[name]=plugin.extract(o);else if(name){if(!$.isArray(data[name]))data[name]=
[data[name]];data[name].push(plugin.extract(o))}});return data};var command,selector,data;switch(arguments.length){case 0:console.log("Try $.dataBind( selector, data )...");return;case 1:command=arguments[0];if($.isPlainObject(command)){selector=command.selector;data=command.data;command=command.command}else{selector=command;data={};command="extract"}break;case 2:selector=arguments[0];data=arguments[1];command="bind";if(!$.isPlainObject(data)){command=data;data={}}break;default:selector=arguments[0];
data=arguments[1];break}return plugin[command](selector,data)};$.fn.dataBind=function(data){return arguments.length?$.dataBind(this,data):$.dataBind(this)};$.fn.lazyFind=function(s){var results=$();$(this).children().each(function(i,o){o=$(o);results=results.add(o.is(s)?o:o.lazyFind(s))});return results};$.lazyFind=function(s){return $(document).lazyFind(s)}})(jQuery);